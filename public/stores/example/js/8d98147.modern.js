(window.webpackJsonp=window.webpackJsonp||[]).push([[1,102],{465:function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return w}));var o=r(0),c=r(1),n=(r(7),r(8),r(36),r(19),r(9),r(10),r(2),r(18)),d=r(189),l=r(667),h=r(489),m=r(525),f=r(60),y=r(581),v=r.n(y),P=(r(582),r(547)),D=r(535),I=r(433);function O(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function C(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?O(Object(r),!0).forEach((function(e){Object(o.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var S=r(37);var w={mixins:[f.a,l.a,m.a,h.a],data(){return{skipMinConfigType:!1,sizesDefaultValues:{},selectedColor:"",updatedParts:Date.now(),updatedAt:Date.now(),deletedColorAt:Date.now(),loadedPrices:!1,skeletonLoaded:!1,loaded:!1,part:{id:"",color:""},showDate:!1,chooseColorOnInit:!0,loadOnInit:!0,selectedSubParts:[],selectedPartsQuantities:[],selectedSubPartsByIndex:[],selectedParts:[{}],selectedPart:{pricing:[]},orderData:{quantity:"",artworkFiles:[],customerComments:{},CustomerPhoneNumbers:[{countryCode:"1",countryISO:"US",phoneType:"Cell"}]},config:{wrap:!0,altFormat:"m/d/Y",altInput:!0,minDate:this.mPowerMoment&&new Date(this.mPowerMoment().startOf("day")),dateFormat:"m/d/Y"}}},props:{productData:Object,preselectedData:Object},created(){var t=this;return Object(c.a)((function*(){try{t.loadOnInit&&(yield t.loadProductData()),t.$emit("onLoad")}catch(t){console.log(t)}}))()},watch:{orderArtworkFiles(){this.$emit("change-artworks",this.orderArtworkFiles)},selectedPartsQuantities:{handler(t){this.orderData&&(this.orderData.quantity=t.map((i=>parseInt(i))).reduce(((a,b)=>a+b),0))},deep:!0},selectedSubPartsByIndex:{handler(t){this.selectedSubParts=[].concat.apply([],t)},deep:!0}},methods:{loadedMoreParts(){this.loadProductData(),this.updatedParts=Date.now()},loadProductData(){var e=this;return Object(c.a)((function*(){try{var r=e.availablePartsColors&&e.availablePartsColors.length?e.availablePartsColors:e.productData.parts,{partId:o,part:c,orderId:n,poId:d,cartModalType:l}=e.preselectedData||e.$route.query,{quantity:h}=e.preselectedData||e.$route.query;l&&(e.cartModalType=l),h||(h=e.minQuantity);var m=(Array.isArray(c)?c:c?[c]:["".concat(o).concat("_").concat(h)]).map((t=>{var r=t.split("_"),o=r.pop(),c=e.productData.parts.find((i=>r.join("_").includes(i.partId))),n=c&&c.ApparelSize&&c.ApparelSize.label_size;if(c&&!c.image&&c.mediaList&&c.mediaList.length){var d=Object(D.e)(c.mediaList,e.storeInformation.partImagesOrder);c.image=d[0]}return C(C({},c),{},{quantity:o,size:n})})),f=t.groupBy(m,"colorName"),y=m.filter((t=>null==t?void 0:t.quantity)).map((i=>parseInt(i.quantity.split("-")[i.quantity.split("-").length-1]))).reduce(((a,b)=>a+b),0),v=Object(P.b)("1",r),I=t.groupBy(t.uniqBy(e.productData.parts,"partId"),"colorName");e.checkProductParts();var O=v.find((t=>t.pricing.find((t=>t.price))))||v.find((t=>t.defaultPart))||v[0];if(e.productData&&(e.checkProductParts(),Object.keys(f).filter((i=>"undefined"!==i)).forEach(((t,c)=>{try{var n=o||f[t][0].partId,d=r.find((p=>p.partId===n));d&&(O=d),O&&e.$emit("selectedPart",O),f[t].some((i=>i.size))?(I[t]=I[t].map((e=>{var r=f[t].find((t=>t.partId===e.partId)),o=r&&r.quantity||0;return C(C({},e),{},{quantity:o})})),e.onChangeSizes(I[t],c)):e.onChangePartQuantity(f[t][0].quantity,c),e.onChangeSelectedPart(f[t][0],c)}catch(t){console.log(t)}})),e.productData.decorations.sort(((a,b)=>{var t,e;return(null===(t=a.name)||void 0===t?void 0:t.toLowerCase())>(null===(e=b.name)||void 0===e?void 0:e.toLowerCase())?1:-1}))),O&&e.chooseColor(O,!0,void 0,!1),e.loggedInCustomer&&(yield e.fillCustomerData()),n){var{data:data}=yield e.$axios.get("/orders/".concat(n,"/purchaseOrders/").concat(d,"?childPOArtworks=true"));e.orderData=Object.assign({},e.orderData,data),e.productData||(e.selectedPart=e.orderData.LineItemArray[0].PartArray[0],e.part.id=e.selectedPart.partId),e.showDate=!!e.orderData.customerComments.dueDate,e.selectedPart&&e.selectedPart.ApparelSize&&!e.allPartsSizes.length&&(e.allPartsSizes=data.LineItemArray[0].PartArray.map((t=>C(C({},t.ApparelSize),{},{quantity:t.Quantity.value}))))}e.$set(e.orderData,"quantity",y),e.$route.path.match("/sample/")||"Sample"===e.cartModalType?(e.productPrices.find((t=>"Blank"===t.configurationType))&&e.onSelectedConfigurationType("Blank"),e.$set(e.orderData,"quantity",1)):e.$set(e.orderData,"quantity",y),e.selectedPart&&(e.selectedPart.sizes=[]),e.loaded=!0}catch(t){console.log("----e",t)}}))()},onLoadProduct(){this.selectedPart&&(this.selectedPart.sizes=[]),this.checkProductParts(),this.productView.decoration&&this.productView.decoration.show&&(this.selectedDecoration=this.productData.selectedDecoration),this.$set(this.orderData,"quantity",this.productData.minQuantity),this.checkOrderData(),this.selectedPart&&this.selectedPart.image&&(this.currentImageIndex=this.productImages.findIndex((t=>t.src===this.selectedPart.image.url||t.src===this.selectedPart.image.urlSmall))),this.updated=Date.now(),this.$nextTick((()=>{setTimeout((()=>{this.$refs.carousel&&this.$refs.carousel.slideTo(this.currentImageIndex),this.selectedPart&&this.selectedPart.image&&(this.productImage=this.selectedPart.image.url)}))}))},isOpenModalWhenAdding(t){var e,r=((null===(e=this.storeInformation)||void 0===e?void 0:e.carts)||[]).find((i=>{var e;return(null===(e=i.type)||void 0===e?void 0:e.toLowerCase())===(null==t?void 0:t.toLowerCase())}));return null==r?void 0:r.openModalWhenAdding},createCartOrder(){var t=this;return Object(c.a)((function*(){if(t.orderData.fromProductView=!0,!t.orderData.artworkFiles.length){var e,r=[...(null===(e=t.selectedPart)||void 0===e?void 0:e.mediaList)||[],...(t.allPartsSizes||[]).map((e=>{var r;return(null===(r=t.productData.parts.find((p=>p._id===e.partId)))||void 0===r?void 0:r.mediaList)||[]})).reduce(((a,b)=>[...a,...b]),[])],o=new Map;r.forEach((t=>{o.has(t._id)||o.set(t._id,t)}));var c=Array.from(o.values()),n=c.find((t=>t.automaticallyAttachLogo)),d=n?[n]:c.filter((t=>Object(I.d)(t,"Logo")));d.length>0&&(t.orderData.artworkFiles=d.map((t=>{var e,r=C(C({},t),null===(e=t.ArtworkFileArray)||void 0===e?void 0:e.find((t=>t)));return C(C({},r),{},{fileType:r.artworkType,fileThumbLocation:r.urlSmall||r.url,fileLocation:r.url||r.urlOrigin||r.fileLocation,fileName:r.fileName||r.url.split("/").pop()})})))}var{createdOrder:l}=yield t.createOrderRequest("cart"),h=l.PurchaseOrders.filter((t=>!t.parentPoId)).pop(),{carts:m=[]}=t.storeInformation,f=m.find((i=>"Cart"===i.type)),path=t.orderData.orderId?"/cart":"/cartitemsadded",y=!0;f&&f.skipAddToCartPage&&(y=!1,path="/".concat(f.route));var v=t.isOpenModalWhenAdding("cart");y||v?yield t.onAddToCart((()=>{t.$router.push({path:path,query:y&&{orderId:l.orderId,poId:h.friendlyPurchaseOrderDetailId,productId:h.LineItemArray[0].productId,total:(parseFloat(h.productTotal)-parseFloat(h.discountTotal)).roundCeil()}})})):t.$router.push({path:path}),t.notificateSuccess("Item Added To Cart")}))()},onAddToCart(t){var e=this;return Object(c.a)((function*(){try{e.isOpenModalWhenAdding("cart")?yield e.$store.dispatch("sidebars/TOGGLE_CART_SIDEBAR","Cart"):yield t()}catch(t){console.log("onAddToCart",t)}}))()},checkOrderData(){this.showDecoration?(this.defaultDecoration&&(this.$set(this.orderData,"decorationName",this.defaultDecoration.name),this.$set(this.orderData,"decorationId",this.defaultDecoration.decoration_id||this.defaultDecoration.decorationId)),this.defaultLocation&&(this.$set(this.orderData,"locationName",this.defaultLocation.name),this.$set(this.orderData,"locationId",this.defaultLocation.location_id||this.defaultLocation.locationId)),this.setUpChargePrice&&this.$set(this.orderData,"charge",this.setUpCharge||this.defaultDecoration&&this.defaultDecoration.selectedCharge)):["charge","locationName","decorationName"].forEach((t=>delete this.orderData[t]))},onChangeSizes(t){var e,r,o=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t.forEach((t=>{var o=this.productData.parts.find((e=>e._id===t.partId));null!=o&&o.disabled&&t.quantity&&(r||(r=t.quantity),t.quantity=null,t.count=null,e=t.partId)})),e&&!t.find((t=>t.quantity)))for(var n=function(i){var c;if((null===(c=t[i-1])||void 0===c?void 0:c.partId)===e){if(!o.productData.parts.find((e=>e._id===t[i].partId)).disabled)return t[i].quantity=r,1;e=t[i].partId}},i=0;i<t.length&&!n(i);i++);for(;this.partSizes.length;)this.partSizes.shift();this.partSizes.push(...t);var d=t.map((t=>parseInt(t.quantity||t.count))).filter((t=>t)).reduce(((a,b)=>a+b),0);this.$set(this.selectedPartsQuantities,c,d),this.$set(this.partsSizesByIndex,c,t),this.sizesDefaultValues={},this.updatedAt=Date.now()},onClearPartsSizes(){this.partsSizesByIndex=[]},onChangePartQuantity(t,e){this.$set(this.selectedPartsQuantities,e,t)},onSelectSubPart(t){var{list:e,part:r}=t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.$set(this.selectedSubPartsByIndex,o,e),r&&r.image&&"1"===r.partGroup&&this.chooseImage(r.image.url,null,!0),this.updatedAt=Date.now()},clearSelectedParts(){this.selectedParts=[],this.selectedPartsQuantities=[]},setPartsSizesQuantity(t){this.allPartsSizes.forEach((i=>{i.quantity=t}))},onChangeSelectedPart(t,e){this.$set(this.selectedParts,e,t),this.$emit("selectedPart",t)},onRemoveColor(t){this.selectedParts.splice(t,1),this.partsSizesByIndex.splice(t,1),this.selectedSubPartsByIndex.splice(t,1),this.selectedPartsQuantities.splice(t,1),this.deletedColorAt=Date.now()},fillCustomerData(){var t=this;return Object(c.a)((function*(){var{data:data}=yield t.$axios.get("/customers/".concat(t.loggedInCustomer._id));t.orderData=Object.assign({},t.orderData,data),t.orderData.CustomerPhoneNumbers&&t.orderData.CustomerPhoneNumbers.length?t.orderData.CustomerPhoneNumbers=[t.orderData.CustomerPhoneNumbers.pop()]:t.orderData.CustomerPhoneNumbers=[{}],t.orderData.artworkFiles||(t.orderData.artworkFiles=[]),t.orderData.companyId&&(t.orderData.companyName="string"==typeof t.orderData.companyId?(yield t.$axios.get("/companies/".concat(t.orderData.companyId._id))).data.companyName:t.orderData.companyId.companyName)}))()},chooseImage(t,e,r,o){var n=this;return Object(c.a)((function*(){var c,d=n.productImages;void 0!==e&&(c=d[e]),d&&d.length||(d=[].concat.apply([],n.productData.parts.map((t=>t.mediaList.map((image=>C(C({},image),{},{src:image.url,srcSmall:image.urlSmall,color:t.colors.map((t=>t.name)).join("/")||t.partId}))))))),c||(c=d.find((e=>(e.part_id||e.partId)&&[e.url,e.urlSmall,e.src,e.srcSmall].includes(t)))),c||(c=d.find((e=>[e.url,e.urlSmall,e.src,e.srcSmall].includes(t)))),c||(c=n.productData.imageDefault),c&&(n.$nextTick((()=>{n.$set(n.productData,"imgUrl",c.url),n.$set(n.productData,"imgUrlSmall",c.urlSmall),n.productImage=n.productData.imgUrl})),yield n.checkSelectedPart(c,r,e)),o&&o()}))()},checkSelectedPart(t,e,r){var o=this;return Object(c.a)((function*(){var c=o.selectedPart,n=t.color||t.caption,d=o.productData.parts.find((e=>t.partId&&t.partId===e.partId||n&&e.colorName===n)),l=0;if(!d&&o.$refs.partsColor&&t.partId&&(l=d=yield o.$refs.partsColor.chooseColor({partId:t.partId})),d&&(n||(n=d.colors.map((t=>t.name)).join("/")||d.partId),n))if(o.selectedColor=d.colorNameRelativeLabel,e||"1"!==d.partGroup){if(void 0===r){var h=o.productImages;t.image?o.currentImageIndex=h.findIndex((e=>e.src===t.image.url||e.src===t.image.urlSmall)):t.src&&(o.currentImageIndex=h.findIndex((e=>t.url===e.url))),o.currentImageIndex<0&&(o.currentImageIndex=o.productData.parts.findIndex((e=>e.partId===t.partId)))}else o.currentImageIndex=r;o.focusCarusel()}else{var m;(null==c?void 0:c._id)!==(null===(m=d)||void 0===m?void 0:m._id)&&(o.$refs.partsColor?(o.$refs.partsColor.mainPart=d,o.$refs.partsColor.chooseColor(d,l)):o.chooseColor(d,!0,r))}}))()},focusCarusel(){this.$refs.carousel&&setTimeout((()=>{var t=this.currentImageIndex-this.currentImageIndex%this.$refs.carousel.itemsToShow;this.$refs.carousel.slideTo(t)}),100)},uniqueParts(t){var e=[],r=t.filter((t=>("1"===t.partGroup||void 0===t.partGroup)&&"discontinued"!==t.status));return(r=[...r.filter((t=>t.partId||t.part_id)),...r.filter((t=>t.partId||t.part_id))]).filter((t=>{if(t.colorName)return!(e.indexOf(t.colorName.toLowerCase())>-1)&&(e.push(t.colorName.toLowerCase()),!0)}))},chooseColor(t,e){t.sizes||(t.sizes=[]),!t.ApparelSize&&this.allPartsSizes&&this.$set(this.partsSizesByIndex,0,[]),this.selectedPart=t,this.part.color=t.colorName,this.part.id=t.partId,this.selectedPart&&(this.selectedColor=this.selectedPart.colorNameRelativeLabel),t.image&&this.$set(this.productData,"imgUrl",t.image.url),this.$emit("selectedPart",t)},trackDevice(t){var e=this;return Object(c.a)((function*(){var{_id:r,customerId:o}=t,data=C(C({},yield Object(d.a)()),{},{orderId:r,customerId:o});return e.$axios.post("orderdevices",data)}))()},createOrderRequest(t){var e=arguments,r=this;return Object(c.a)((function*(){var o=e.length>1&&void 0!==e[1]?e[1]:{},c=!(e.length>2&&void 0!==e[2])||e[2],n=yield r.getReCaptchaToken();r.checkOrderData();var{productName:d,noChargeStore:l,productId:h,supplierId:m,imgUrl:f,productImageSrc:y,decorationProducts:v=[],indexId:P}=r.productData||r.orderData.LineItemArray[0];delete r.orderData.productImageSrc,delete r.orderData.productTotal;var D=r.totalSubPartsPrice,I=!!r.selectedPart.ApparelSize,O=I?r.totalPriceWithSizes:r.totalPrice,w="Decorated"===r.selectedConfigurationType,j="sample"!==t,_=j?r.setUpChargePriceVal:0;w&&v.length&&(O.calWithOriginPrices&&Object.assign(O,O.calWithOriginPrices),O.parts&&O.parts.forEach((t=>{Object.assign(t,t.partCalWithOriginPrices)})),r.selectedDecoration&&r.productData&&r.selectedDecoration.productId===r.productData._id||(O.setUpChargePrice=0,O.parts&&O.parts.forEach((t=>t.setUpChargePrice=0))),_=O.setUpChargePrice);var L,x=O.parts||[];r.setUpChargePriceAdditional>0&&(r.orderData.charges=((null===(L=r.selectedDecoration)||void 0===L?void 0:L.charges)||[]).filter(((t,e)=>e>0)));var T=C(C(C({},o),O),r.orderData);try{if(!x.length&&["cart","configured"].includes(t)&&["unitPrice","unitCost","margin"].filter((t=>T[t])).length<3){var N=JSON.parse(JSON.stringify(r.selectedPart)),k=r.minPartPriceInfo(N,r.orderData.quantity);N.unitPrice||(N.unitPrice=k.unitPrice),N.unitCost||(N.unitCost=k.unitCost),N.margin||(N.margin=k.margin),x.push(N)}}catch(t){console.log(t)}O.productTotal-=_,I&&O.parts&&O.parts.forEach(((t,e)=>{0===e&&(t.productTotal-=_)})),D&&D.parts.length&&(x="configured"===t?[].concat.apply([],x.map((i=>{var t=D.parts.filter((t=>t.afterPartId===i._id));return[i,...t]}))):[C(C({},r.selectedPart),O),...D.parts]);var $=[];if(w&&($=v.map((t=>{var e=t.parts.map((t=>{var e=t.pricing.filter((t=>t.configurationType===r.selectedConfigurationType));return e.length||(e=t.pricing.filter((t=>!t.configurationType))),C(C({},t),{},{pricing:e})})),o=C(C({},t),{},{parts:e.filter((e=>t.selectedPart===e._id))});return o.parts.length||(o.parts=e.filter((e=>t.selected))),!o.parts.length&&e.length&&(o.parts=[e[0]]),o})).filter(((t,e)=>t.parts.length&&(!r.selectedDecoration||t.selectedDecoration&&t.selectedDecoration._id===r.selectedDecoration._id||t.locations.find((t=>t.decorations.map((t=>t._id)).includes(r.selectedDecoration._id)))))),v&&v.length&&!$.length))throw"There is no ".concat(r.selectedConfigurationType," pricing configured for the decorated product.");var{poId:A}=r.preselectedData||r.$route.query,{categories:z,facets:G}=r.productData,{carts:E=[]}=r.storeInformation,U="quote"===t?"Quote":"artproof"===t?"Proof":"sample"===t?"Sample":"box"===t?"Box":"Cart";r.$route.path.toLowerCase().match("/largequote/")&&(U=null);var Q=E.find((i=>i.type===U)),B=S.get("cartOrders")||void 0;B=B?JSON.parse(B):[];var data,F=Q?B.find((i=>i.type===U)):B[0],M={order:C(C(C(C(C({},o),O),r.orderData),{},{storeId:r.storeInformation._id},m&&{supplierId:m._id||m}),{},{poId:A,productName:d,noChargeStore:l,decorationProducts:$.map((t=>{var e;return r.calcTotalDecorated(C(C({},t),{},{supplierId:null!==(e=t.supplierId)&&void 0!==e&&e._id?t.supplierId:{_id:t.supplierId,psCode:t.supplierCode},categories:z,facets:G,parts:t.parts.map((e=>C(C({},t.parts[0]),{},{quantity:x.map((t=>t.quantity)).reduce(((a,b)=>a+b),0)||r.orderData.quantity})))}))})).slice(0,1).map((t=>C(C({},t),{},{total:t.productTotal,productTotal:t.productTotal-(j?r.setUpChargePriceVal:0)}))),productId:h,cardOrderId:null==F?void 0:F._id,localProduct:r.productData&&r.productData._id,productImageSrc:f||y,parts:x.map((t=>C(C({},t),{},{partId:t.partId,partColor:t.colorName}))),partId:r.part.id,partSKU:r.part.indexId,productSKU:P,partColor:r.part.color,recaptchaToken:n}),cartType:Q?Q.type:null};r.storeInformation.allowNoPricing&&["unitPrice","unitCode","price","margin","listPrice","productTotalCost","productTotal","total","productDiscount","perEach"].forEach((t=>{M.order[t]&&!isNaN(M.order[t])||(M.order[t]=0)})),"Blank"===r.selectedConfigurationType&&"sample"!==t&&(M.poType="Blank");try{var R,H;if(data=(M.order.orderPOUid?yield r.$axios.put("orders/".concat(M.order.orderId,"/purchase-orders/").concat(A,"/stores/").concat(t),M):yield r.$axios.post("orders/store/".concat(t),M)).data,B&&null!==(R=data)&&void 0!==R&&null!==(R=R.createdOrder)&&void 0!==R&&R._id&&(null===(H=B)||void 0===H||null===(H=H.find((t=>t.type===U)))||void 0===H?void 0:H._id)!==data.createdOrder._id){var V,J=null===(V=B)||void 0===V?void 0:V.find((t=>t.type===U));J&&J._id!==data.createdOrder._id&&(J._id=data.createdOrder._id,S.set("cartOrders",JSON.stringify(B)))}}catch(t){var W,K=(null==t||null===(W=t.response)||void 0===W||null===(W=W.data)||void 0===W?void 0:W.message)||"";throw new Error(/Recaptcha|not allow orders/.test(K)||K?K:"Cannot process order")}try{var Y=r.productData;Y.categoriesUsed=(r.productCategories||[]).map((t=>t.name));var X=window.dataLayer;X.push({ecommerce:null}),X.push({event:"add_to_cart",ecommerce:{items:[C(C({},r.productItemDataLayer(r.productData)),{},{item_id:r.productData.productId,item_list_id:"add-to-cart-".concat(r.productData.slug),item_list_name:"add to cart ".concat(r.productData.slug.split("_").map((t=>t.toCapitalize())).join(" ")),price:(M.order.total/M.order.quantity).roundCeil(),discount:M.order.productDiscount,quantity:M.order.quantity,variant:Y.parts.map((t=>t.colorName))[0]||""})]}})}catch(t){console.log(t)}r.loggedInCustomer||!t||"artproof"===t&&"Proof"!==U||F||(B.push({type:U,_id:data.createdOrder._id}),S.set("cartOrders",JSON.stringify(B))),r.trackDevice(data.createdOrder);var Z=r.loggedInCustomer&&r.loggedInCustomer._id;return data.createdOrder&&data.createdOrder.orderId&&c&&(yield r.$store.dispatch("cart/loadOrders",{orders:[data.createdOrder._id],customerId:Z,storeInformation:r.storeInformation,forceLoad:!0,addToExistsOrders:!0})),data}))()}},computed:C(C({},Object(n.c)({loggedInCustomer:"auth/loggedInUser",storeInformation:"storeInformation"})),{},{backProductUrl(){var{partId:t}=this.$route.query;return"/products/".concat(this.productData.slug).concat(t?"?partId=".concat(t):"")},orderArtworkFiles(){return this.orderData.artworkFiles},minPartDataInfo(){return this.minPartPriceInfo(this.selectedPart,null,this.skipMinConfigType)},minQuantity(){var t;return(null===(t=this.minPartDataInfo)||void 0===t?void 0:t.minQuantity)||0},minProductQuantity(){return this.minPartPriceInfo(this.selectedPart,1,!0).minQuantity},defMinQuantity(){return this.isModal?this.minQuantity:this.defMinQuantityV1},defaultLocation(){return this.defaultDecoration?this.defaultDecoration.location||this.product.locations.length&&this.product.locations[0]:null},setUpCharge(){return this.defaultDecoration?this.defaultDecoration.setupCharge||this.defaultDecoration.selectedCharge:null},hasError(){return!!this.selectedPart.ApparelSize&&(this.allPartsSizes&&this.allPartsSizes.map((t=>t.quantity)).reduce(((t,e)=>parseFloat(t||0)+parseFloat(e||0)),0)<this.minQuantity)},setUpChargePrice(){return this.productData.decorationProducts.length>1&&!this.selectedDecoration?0:parseFloat(this.defaultDecoration&&this.defaultDecoration.setupChargePrice||0)},productPrices(){var{partId:t}=this.orderData||this.$route.query,e=this.productData.parts.find((e=>e.partId===t));return e||(e=this.productData.parts[0]),e.pricing},totalPriceWithSizes(){return this.calcTotalWithSizes(this.productData.parts)},totalPrice(){this.updatedAt;var t=this.productData?this.productData.parts:[],{path:path}=this.$route;return this.selectedParts.length?this.totalPriceByMultipleParts:this.calcTotal(this.selectedPart,t)},totalPriceByMultipleParts(){var t=this.productData?this.productData.parts:[];if(this.allPartsSizes.length)return this.calcTotalWithSizes(t,!1);var e=[];this.selectedParts.forEach(((r,o)=>{var c=this.calcTotal(r,t,!0,!1,this.selectedPartsQuantities[o]);e.push(C(C(C({},c),r),{},{quantity:this.selectedPartsQuantities[o]}))}));var r=t=>e.map((i=>i[t])).reduce(((a,b)=>a+b),0),o=e.map((i=>i.setUpChargePrice)).filter(((i,t)=>t>0)).reduce(((a,b)=>a+b),0),c=r("unitCost"),n=r("unitPrice");return{parts:e,margin:(c/n*100).roundCeil(),productTotal:r("productTotal")-o,productTotalCost:r("productTotalCost")-o,productDiscount:r("productDiscount")}}}),components:{flatPickr:v()}}}).call(this,r(61))},489:function(t,e,r){"use strict";r.d(e,"a",(function(){return l})),r.d(e,"b",(function(){return d}));r(2);var o=r(0);r(13);function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){Object(o.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var d={methods:{_defaultSelectedDecoration(){if(!this.productData)return console.log("NO Product"),!1;var t=this.$route.query.decoration;if(t){t="".concat(t).toLowerCase();var e=this._defaultSelectedLocation();if(e)return e.decorations.find((i=>"".concat(i.decorationId||i.decoration_id||"").toLowerCase()===t||(i._id&&i._id.toString().toLowerCase())===t||(i.name||"").toLowerCase()===t))}},_defaultSelectedLocation(){var t=this.productData;if(!t)return console.log("NO Product"),!1;var e=this.$route.query.decoration,r=this.$route.query.location;if(r)return r=r.toLowerCase(),t.locations.find((t=>(t.locationId||t.location_id||t._id)===r||t.name&&t.name.toLowerCase()===r));var o=t.locations;return t.selectedDecoration&&t.selectedDecoration.location&&o.find((e=>e._id===t.selectedDecoration.location._id))||o.find((t=>t.default))||o.find((t=>t.decorations.find((i=>i.default&&("".concat(i.decorationId||i.decoration_id||"").toLowerCase()===e||(i.name||"").toLowerCase()===e)))))||o.find((t=>t.decorations.find((i=>"".concat(i.decorationId||i.decoration_id||"").toLowerCase()===e||(i.name||"").toLowerCase()===e))))}},computed:{product(){return this.productData},defaultSelectedLocation(){return this._defaultSelectedLocation()},defaultSelectedDecoration(){return this._defaultSelectedDecoration()}}},l={methods:{confirmConfigureProduct(t){var{carts:e=[]}=this.storeInformation,r=e.find((i=>"Cart"===i.type)),path="/cartitemsadded",o=!0;r&&r.skipAddToCartPage&&(o=!1,path="/".concat(r.route)),this.$router.push({path:path,query:o&&n({},t)})}},mixins:[d],computed:{backProductUrl(){var{partId:t}=this.$route.query;return"/products/".concat(this.productData.slug).concat(t?"?partId=".concat(t):"")},defaultDecoration(){if(this.productData&&this.productData.isQuoteOnly||!this.product)return null;var t=this.product&&(this.product.selectedDecoration||this.product.decorations[0]||this.product.locations.length&&this.product.locations[0].decorations[0])||this.defaultSelectedDecoration||null;if(this.product&&this.product.selectedDecoration);else if(t&&t.charges&&t.charges[0]){var e=t.charges.find((t=>"setup"===t.type&&t.pricing.find((t=>parseFloat(t.price)))))||t.charges[0],r=n(n({},e),e.pricing.find((t=>parseFloat(t.price)))||e.pricing[0]);t.setUpCharge=t.setupCharge=r,t.setupChargePrice=r.price}return t}}}},525:function(t,e,r){"use strict";r.d(e,"a",(function(){return m}));r(2);var o=r(1),c=r(0),n=(r(8),r(460)),d=r(4),l=r(18);function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}var m={computed:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach((function(e){Object(c.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},Object(l.c)({storeInformation:"storeInformation"})),created(){var t;d.default.use(n.VueReCaptcha,{siteKey:null===(t=this.storeInformation.reCaptcha)||void 0===t?void 0:t.siteKey})},methods:{getReCaptchaToken(){var t=this;return Object(o.a)((function*(){return["local","development"].includes("production")?"":(yield t.$recaptchaLoaded(),yield t.$recaptcha("login"))}))()}}}},535:function(t,e,r){"use strict";r.d(e,"c",(function(){return m})),r.d(e,"d",(function(){return f})),r.d(e,"b",(function(){return y})),r.d(e,"a",(function(){return v})),r.d(e,"e",(function(){return P}));r(2);var o=r(0),c=(r(7),r(36),r(8),r(9),r(10),r(433));function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){Object(o.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var l=[{id:"1004",name:"swatch"},{id:"4004",name:"ArtTemplate"},{id:"4005",name:"Marketing"}],h=[{id:"1002",name:"decorated"},{id:"1007",name:"front"},{id:"1006",name:"primary"}];function m(t){for(var e,r=arguments.length>2?arguments[2]:void 0,o=[...arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]],n=null==r||null===(e=r.imagesClassTypesOrder)||void 0===e||null===(e=e.find((e=>e.groups.find((g=>{try{var e=g.split("-");return t.find((i=>null==i?void 0:i.classTypes.find((t=>g===t.class_type_id||e&&e[0]<=t.class_type_id&&e[1]&&e[1]>=t.class_type_id))))}catch(t){}})))))||void 0===e?void 0:e.groups.map((t=>({id:t}))),l=JSON.parse(JSON.stringify(n||h)).map(((t,e)=>d(d({},t),{},{index:e}))),m=l.map((e=>{var r=t.filter((img=>img&&o.indexOf(img.urlSmall)<0&&Object(c.b)(img,e.id))).map((t=>{var e;return d(d({},t),{},{index:(null===(e=l.find((p=>{try{var e=p.id.split("-");return t.classTypes.find((t=>t.class_type_id===p.id||e&&e[0]<=t.class_type_id&&e[1]&&e[1]>=t.class_type_id))}catch(t){}})))||void 0===e?void 0:e.index)||l.length+1})})).sort(((a,b)=>a.index-b.index));return o=[...o,...r.map((t=>t.urlSmall))],r})).reduce(((a,b)=>[...a,...b]),[]),f=[...m,...t.filter((img=>o.indexOf(img.urlSmall)<0))],y=[],v=[],D=[],i=0;i<f.length;i++){var I=f[i].partId||f[i].part_id||f[i].productPart;if(I&&y.indexOf(I)<0){var O=[];D.indexOf(f[i].urlSmall)<0&&(O.push(f[i]),D.push(f[i].urlSmall),y.push(I));for(var C=0;C<f.length;C++){var S=f[C].partId||f[C].part_id||f[C].productPart;S===I&&D.indexOf(f[C].urlSmall)<0&&(O.push(f[C]),D.push(f[C].urlSmall),y.push(S))}r.mediaTypePriority&&(O=P(O,r.mediaTypePriority)),v.push(...O)}}for(var w=0;w<f.length;w++)D.indexOf(f[w].urlSmall)<0&&v.push(f[w]);return o=[...o,...v.map((t=>t.urlSmall))],{list:v,imagesWithPartIds:o}}function f(t){var{excludeType:e,onlyType:r,productParts:o,imageDefault:n}=t,h=JSON.parse(JSON.stringify(o)),m=n&&JSON.parse(JSON.stringify(n)),f=!1,y=[],v={},P=[].concat.apply([],h.map((t=>{var o=[];y.push(t.partId||t.part_id),!f&&m&&(f=!0,o.push(m));for(var n=l,i=0;i<t.mediaList.length;i++){var img=t.mediaList[i];if(!(!img||img.type&&(e&&e.includes(img.type)||r&&!r.includes(img.type))||!img.type&&r&&r.length)){for(var h=[],P=0;P<n.length;P++)Object(c.b)(img,n[P].id)&&h.push(1);if(!(!img.url||(Array.isArray(img.classTypes)&&img.classTypes.length?img.classTypes.length===h.length:h.length>0))){for(var D=0;D<o.length;D++){var I=o[D];if(I.url===img.url){(img.partId||img.part_id)&&Object.assign(I,img),img=null;break}}img&&!v[img._id]&&(v[img._id]=1,o.push(img))}}}return o.map((image=>d(d({},image),{},{defaultPart:t.defaultPart,caption:!image.partId||image.partId&&image.partId===t.partId||image.color&&t.colors.map((t=>t.name&&t.name.toLowerCase())).includes(image.color.toLowerCase())?t.colors.map((t=>t.name)).join(",")||t.partId:image.partId,thumb:image.urlSmall||image.url,src:image.urlSmall||image.url,urlSmall:image.urlSmall||image.url})))})));return{partsId:[...new Set(...y)],media:P}}function y(t,e){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3?arguments[3]:void 0,data=f({excludeType:["Document","Video","Audio"],productParts:t,imageDefault:e}),n=data.media,d=data.partsId,l=[],h=[],y=[],v=[],i=0;i<n.length;i++)!n[i].partId&&!n[i].part_id||d.includes(n[i].partId||n[i].part_id)?v.indexOf(n[i].url)<0&&(v.push(n[i].url),y.push(n[i])):l.indexOf(n[i].url)<0&&(l.push(n[i].url),h.push(n[i]));var P=[],D=[...(n=y).filter((a=>a.partId||a.part_id)),...n.filter((a=>!(a.partId||a.part_id)))];n=[],D.forEach((t=>{P.indexOf(t.urlSmall)<0&&(P.push(t.urlSmall),n.push(t))}));var I=m(n.filter((a=>a.partId||a.part_id||a.productPart)),[],o).list,O=I.map((t=>t.urlSmall)),C=m(n.filter((t=>t.defaultPart&&O.indexOf(t.urlSmall)<0)),[],o).list;O=[...O,...C.map((t=>t.urlSmall))];var s=m(n,O,o).list;return[...I,...C,...s,...h].filter((i=>i&&(!r||!Object(c.d)(i,"Logo"))))}function v(t,e){var r=p=>p.colorName||p.colorNameLabel||p.partDescription||(p.colors||[])[0]&&p.colors[0].name,o=r(t);if(o){var c=e.find((p=>p.imageDefault&&o===r(p)));return c&&c.imageDefault}}function P(t,e){var r=(e||[]).reduce(((e,r)=>{var o=(t||[]).filter((i=>!e.includes(i)&&Object(c.d)(i,r)));return[...e,...o]}),[]);return[...r,...(t||[]).filter((i=>!r.includes(i)))]}},547:function(t,e,r){"use strict";r.d(e,"b",(function(){return c})),r.d(e,"a",(function(){return n}));r(36),r(7),r(19);var o=r(452),c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3?arguments[3]:void 0;t||(t="1");e=e.filter((e=>(e.partGroup===t||void 0===e.partGroup&&"1"===t)&&"discontinued"!==e.status&&("NONE"===e.partId||r||e.pricing&&e.pricing.length)));var n=e.filter((t=>t.nextPartGroup>t.partGroup)),d=e.filter((t=>t.nextPartGroup<=t.partGroup||!t.nextPartGroup));e=[...n.filter((t=>t.partId||t.part_id)),...d.filter((t=>t.partId||t.part_id)),...n.filter((t=>!(t.partId||t.part_id))),...d.filter((t=>!(t.partId||t.part_id)))].filter((t=>t));for(var l={},i=0;i<e.length;i++){var h=e[i];h.quantity=h.quantity||h.minQuantity;var m=("1"===t?h.colorName&&h.colorName.toLowerCase():h.ApparelSize&&h.ApparelSize.label_size||h.partId||h.colorName&&h.colorName.toLowerCase())||h.partId;if(h.ApparelSize&&h.ApparelSize.label_size&&!h.ApparelSize.code&&(h.ApparelSize.code=o.a.indexOf(h.ApparelSize.label_size.toUpperCase())),h.ApparelSize&&h.ApparelSize.label_size||(m+=h.partDescription),t>"1"&&h.partGroup>"1"&&(m+=h.partId),m=m.substr(0,50),!h.minPrice)if(h.pricing&&h.pricing[0]){var{price:f,quantity:y,unitPrice:v,minQuantity:P}=h.pricing[0];h.price=f||v,h.minPrice=h.price*(y||P)}else h.minPrice=1/0;(!l[m]||m&&l[m]&&(l[m].minPrice>h.minPrice||h.ApparelSize&&l[m].ApparelSize&&l[m].minPrice.toFixed(5)===h.minPrice.toFixed(5)&&l[m].ApparelSize.code>h.ApparelSize.code)||c&&c.partId&&c.partId===h.partId)&&(l[m]=h)}return Object.values(l).sort(((a,b)=>(a.partGroup||100)>=(b.partGroup||100)?1:-1))||[]},n=(t,e)=>{if(t){var canvas=document.createElement("canvas");canvas.width=canvas.height=300;var div=document.createElement("div");if(div.style.backgroundColor=t,!div.style.backgroundColor){var r=t.split(" ").filter((t=>{if(!t)return!1;var div=document.createElement("div");return div.style.backgroundColor=t,div.style.backgroundColor}));div.style.backgroundColor="linear-gradient(90deg, ".concat(r.join(", "),")")}if(!div.style.backgroundColor&&e){var o=e.toLowerCase().split(" ").filter((t=>{if(!t)return!1;var div=document.createElement("div");return div.style.backgroundColor=t,div.style.backgroundColor}))||[];o.length>1?div.style.backgroundColor="linear-gradient(90deg, ".concat(o.join(", "),")"):o.length&&(div.style.backgroundColor=o[0])}if(!(t=div.style.backgroundColor))return;var c=canvas.getContext("2d");if(t.match("gradient")){var n=t.substr(t.indexOf("deg,")+5)||"";n=n.substr(0,n.length-1);var d=c.createLinearGradient(0,0,canvas.width,0);(n=n.split(",")).forEach(((t,e)=>d.addColorStop(e/(n.length-1),t))),c.fillStyle=d}else c.fillStyle=t;return c.fillRect(0,0,canvas.width,canvas.height),canvas.toDataURL()}}},667:function(t,e,r){"use strict";r.d(e,"a",(function(){return v}));var o=r(0),c=(r(8),r(9),r(10),r(19),r(2),r(36),r(6),r(7),r(547)),n=r(535),d=r(433),l=r(12),h=r(18);function m(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?m(Object(r),!0).forEach((function(e){Object(o.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var y=[l.a.Decorated,l.a.Blank,l.a.Sample,l.a.Box];var v={data:()=>({prevTypes:[],productImage:"",subPartsLabel:"",selectedColor:""}),methods:{chooseColorLocal(t,e){this.selectedPart=t,this.part.color=t.colorName,this.part.id=t.partId,e&&t.image&&(this.productData.imgUrl=t.image.url),this.chooseColor(t,e)},checkProductParts(){try{var t=this.productData;this.productData.defaultDecoration=this.defaultDecoration;var e=t.parts.map((t=>t.pricing.map((t=>t.configurationType)))).reduce(((a,b)=>[...a,...b]),[]).filter((t=>!((this.productViewModalPricing||[]).length>0)||this.productViewModalPricing.includes(t)));if(e=[...new Set(e)].filter((t=>t)),this.storeInformation&&(this.storeInformation.suppliersHideBlankPrices||[]).includes(this.productData.supplierId._id)&&(e=e.filter((t=>t!==l.a.Blank))),e.length&&(!this.$route.query.configurationType&&this.prevTypes.length!==e.length||!this.selectedConfigurationType||!e.includes(this.selectedConfigurationType))){var r=y.find((t=>e.includes(t)));this.onSelectedConfigurationType(r||e[0]),this.prevTypes=e}if(t.parts&&t.parts.length){t.parts=[...t.parts.filter((t=>t.partId||t.part_id)),...t.parts.filter((t=>!(t.partId||t.part_id)))];for(var o=t.parts,h=o.length>1&&o[0].partDescription&&o[0].partDescription===o[1].partDescription||"GOLDSTAR"===t.supplierCode,m=this.productImages,f=[],v={},P={},i=0,D=o.length;i<D;i++){var I=o[i];I.colorName=I.colors.map((t=>t.name)).join("/")||I.partDescription,I.colorNameLabel=I.partDescription||I.colors.map((t=>t.name)).join("/"),"GOLDSTAR"===t.supplierCode&&(I.colorName+=I.partDescription);try{h&&(I.colorNameLabel="".concat(I.colors.map((t=>t.name)).join("/")||I.partId," ").concat(I.partDescription||"")),I.colorNameLabel=decodeURI(I.colorNameLabel)}catch(t){}I.colorNameLabel=I.colorNameLabel.removeSpecialChars(),o[i].partGroup&&!v[o[i].partGroup]&&(f.push({partGroup:I.partGroup,colorNameLabel:I.colorNameLabel}),v[o[i].partGroup]=!0),I.partGroup||(I.partGroup="1"),P[I.partGroup]||(P[I.partGroup]={count:0,name:I.partGroupDescription}),P[I.partGroup].count++}var O=this.$route.path.match("/products/"),C=[];try{var S;null!==(S=C=Object(c.b)("1",o)||[])&&void 0!==S&&S.length&&O&&(C=Object(c.b)("1",o,O)),C||(C=[])}catch(t){console.log("error:",t),C||(C=[])}this.subPartsLabel=Array.from(new Set(o.map((t=>t.partGroup||"1")).filter((t=>parseInt(t)>1)))).map((t=>"".concat(P[t].count," ").concat(P[t].name))).join(", "),this.subPartsLabel&&(this.subPartsLabel=", "+this.subPartsLabel),f.sort(((a,b)=>a.partGroup>b.partGroup));var w=m.map((t=>t._id));o.forEach((t=>{for(var e=[],r=0;r<t.mediaList.length;r++)t.mediaList[r]&&w.includes(t.mediaList[r]._id)&&e.push(t.mediaList[r]);e.length||(e=t.mediaList.filter((t=>t&&t.url))),t.colorNameRelativeLabel="";for(var c=0;c<f.length;c++)parseInt(t.partGroup)>=parseInt(f[c].partGroup)&&(t.colorNameRelativeLabel+=(t.colorNameRelativeLabel?" / ":"")+(t.partGroup===f[c].partGroup?t.colorNameLabel:f[c].colorNameLabel));t.colors[0]&&(t.colors[0].hex?(t.colors[0].hex=t.colors[0].hex.replace(/ /g,""),t.colors[0].hex.match("/")?t.colors[0].hex=t.colors[0].hex.split("/")[1]:t.colors[0].hex.match(",")&&(t.colorHex="linear-gradient(90deg, #".concat(t.colors[0].hex.split(",")[0].replace(/#/g,""),", #").concat(t.colors[0].hex.split(",")[1].replace(/#/g,""),")")),t.colorHex||(t.colorHex="#".concat(t.colors[0].hex))):t.colors[0].name&&(t.colors[0].name.match("/")?t.colorHex="linear-gradient(90deg, ".concat(t.colors[0].name.toLowerCase().split("/").map((t=>t)).join(","),")"):t.colorHex=t.colors[0].name.split(" ")[1],t.colorHex||(t.colorHex=t.colors[0].name),t.colorHex&&(t.colorHex=t.colorHex.toLowerCase()),t.colorHex&&(t.colorHex="".concat(t.colorHex))));var l=m.filter((a=>(a.partId||a.part_id)===(t.partId||t.part_id)||a.color&&(t.colorName||t.colorNameLabel||t.partDescription||"").replace(/ /g,"").toLowerCase()===a.color.toLowerCase().replace(/ /g,""))).sort(((a,b)=>a.url>b.url?1:-1))[0];!e.length&&!l&&t.colorHex;for(var h=[],y=t.colors.map((t=>t.name)).join(""),v=0;v<e.length;v++)e[v].partId===t.partId&&h.push(e.splice(v--,1)[0]);for(var P=0;P<e.length;P++)e[P].color===y&&h.push(e.splice(P--,1)[0]);if(t.image)t.image&&"string"==typeof t.image&&(t.image=t.imageDefault||Object(n.a)(t,o)||e.find((i=>i._id===t.image)));else{for(var D=[h,e],I=0;I<D.length;I++){var O=Object(n.e)(D[I].filter((t=>t)),this.storeInformation.partImagesOrder);if(t.image=t.imageDefault||Object(n.a)(t,o)||O.find((img=>img.partId||img.part_id))||O.find((img=>img.isDefault))||l||O.find((img=>Object(d.c)(img,["1002","1007","1006"]))),t.image)break}t.image||(t.image=e[0])}})),o.forEach((e=>{if(e.image||(e.image=t.imageDefault),!e.image&&e.colorHex){var r=Object(c.a)(e.colorHex,e.colorName||e.colorNameLabel||e.partDescription||"");if(r){var img={generated:!0,partId:e.partId,color:e.colors.map((t=>t.name)).join("/"),url:r,urlSmall:r,urlOrigin:r};e.mediaList.push(img),e.image=img}}}));var j=m[0];j&&!this.productImage&&(this.productData.imgUrl=j.url,this.productData.imgUrlSmall=j.urlSmall,this.productImage=this.productData.imgUrl),C.sort(((a,b)=>{var t,e;return null!==(t=a.image)&&void 0!==t&&t.urlSmall&&null!==(e=b.image)&&void 0!==e&&e.urlSmall&&a.image.urlSmall.length>b.image.urlSmall.length?1:-1})),C.sort(((a,b)=>a.minPrice-b.minPrice)),this.selectedPart||(this.$route.query.partId?this.selectedPart=t.parts.find((i=>i.partId===this.$route.query.partId)):C.length&&(this.selectedPart=C.find((t=>{var e;return t.pricing&&t.pricing.find((t=>t.price))&&(null===(e=t.mediaList)||void 0===e?void 0:e.filter((t=>t&&t.isDefault)).length)>0})),this.selectedPart||(this.selectedPart=C.find((t=>t.pricing&&t.pricing.find((t=>t.price||t.unitPrice))))),!this.selectedPart&&(this.storeInformation.allowNoPricing||this.productData.noPricingStore,1)&&(this.selectedPart=C[0]||this.productData.parts[0]))),this.selectedPart||!this.storeInformation.allowNoPricing&&!this.productData.noPricingStore||(this.selectedPart=C[0]||this.productData.parts[0]),this.selectedPart&&(this.selectedColor=this.selectedPart.colorNameRelativeLabel)}}catch(t){console.log("selected erorr:",t)}}},computed:f(f({},Object(h.c)({storeInformation:"storeInformation"})),{},{documentFiles(){for(var t=Object(n.d)({onlyType:["Document"],productParts:this.productData.parts}).media,e=[],r={},i=0;i<t.length;i++)r[t[i].url]||(r[t[i].url]=1,e.push(t[i]));return e},videoFiles(){for(var t=Object(n.d)({onlyType:["Video","Audio"],productParts:this.productData.parts}).media,e=[],r={},i=0;i<t.length;i++)t[i].url&&!r[t[i].url]&&(r[t[i].url]=1,/\.(jpeg|jpg|png)$/.test(t[i].url)||e.push(t[i]));return e},noPricing(){return this.productData.noPricing||!this.selectedPart||!this.selectedPart.pricing||!this.selectedPart.pricing.find((t=>t.price||t.unitPrice))},productImages(){var t,e,r,o=f(f({},this.productData.supplierId||{}),{},{mediaTypePriority:this.storeInformation.productImagesOrder});this.productData.parts.find((t=>{var e;return null===(e=t.mediaList)||void 0===e?void 0:e.length}))||(r=this.productData.imageDefault);var c=this.productData.parts;if(null!==(t=this.part)&&void 0!==t&&t.colorName){var d=this.productData.parts.filter((t=>t.colorName===this.part.colorName));d.find((t=>{var e,r;return(null===(e=t.mediaList)||void 0===e?void 0:e.length)||(null===(r=t.image)||void 0===r?void 0:r._id)}))&&(c=d)}var l=Object(n.b)(c,r,!0,o);if(this.selectedPart&&null!==(e=this.productView)&&void 0!==e&&e.showOnlyPartImages){var h=(this.productData.parts||[]).filter((p=>p.colorName===this.selectedPart.colorName)).map((p=>p._id));l=l.filter((i=>h.includes(i.productPart)))}return l}})}}}]);